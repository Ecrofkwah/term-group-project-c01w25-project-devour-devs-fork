# Security Measures and Testing

## 1. Authentication, Authorization, and Data Protection

### 1.1 Authentication:
- **JWT-based authentication**: Users log in and receive a token stored in localStorage.
- **Input validation**: using express-validator ensures clean and properly formatted data.

### 1.2 Authorization:
- Users must send a valid JWT in the Authorization header (Bearer `<token>`) for protected routes.
- Tokens are verified using `jwt.verify()`, and user information is attached to `req.user`.

### 1.3 Data Protection:
- **Passwords** are hashed with bcrypt before saving to the database.
- **Input sanitization** using xss to prevent XSS attacks.
- **Emails** are normalized, and **usernames** have strict validation rules:
  - Email must be valid (e.g., `user@example.com`).
  - Username must be 3-30 characters. Only letters, numbers, underscores, and hyphens are allowed. Spaces and special characters are not allowed.
  - Password must be at least 8 characters.

---

## 2. Some Security Tests Performed:

| **Test Type**             | **Description**                                                                 | **Test Steps**                                                                                                                                                    | **Result**                                                                                             | **Conclusion**                                                                                     |
|---------------------------|---------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|
| **NoSQL Injection (MongoDB)** | Test to ensure the app is protected against NoSQL injection attacks.           | 1. Go to login/signup page. <br> 2. Enter `{ "$ne": null }` in the email or username field. <br> 3. Enter a random password. <br> 4. Click login/sign up button. | The app rejected the request and showed the "invalid email” or “invalid username". The new user won’t be logged in or signed up. | The app prevents basic NoSQL injection and handles input validation securely. |
| **XSS Prevention**         | Test to verify the app is protected from Cross-Site Scripting (XSS) attacks.    | 1. Go to the username field. <br> 2. Enter `<script>alert('XSS attack');</script>` in the text fields such as the search bar, login/register input fields. <br> 3. Submit the form and check if the script runs. | The script was displayed as text and didn’t run.                                                         | The input fields prevent XSS by turning scripts into text and blocking execution. |

---

## 3. Additonal Automated Security Testing with OWASP ZAP

We also used [OWASP ZAP](https://www.zaproxy.org/) for automated security scanning and generating a report, which helped detect potential vulnerabilities such as missing Content Security Policy (CSP) headers. The ZAP scan helped us ensure that our app was not vulnerable to common threats like XSS, SQL Injection, and missing security headers.

Please refer to the [security-zap-report.pdf](./security-zap-report.pdf) for details about the report generated by ZAP.
